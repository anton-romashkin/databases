DROP TABLE IF EXISTS flights;
CREATE TABLE flights (
  id SERIAL PRIMARY KEY,
  flight_from VARCHAR(255) COMMENT 'Откуда',
  flight_to  VARCHAR(255) COMMENT 'Куда') COMMENT 'Рейсы';

DROP TABLE IF EXISTS cities;
CREATE TABLE cities (
  label VARCHAR(255) COMMENT 'eng',
  name VARCHAR(255) COMMENT 'рус') COMMENT 'Русские названия городов';

INSERT INTO flights (
  flight_from, flight_to)
VALUES
  ('moscow', 'omsk'),
  ('novgorod', 'kazan'),
  ('irkutsk', 'moscow'),
  ('omsk', 'irkutsk'),
  ('moscow', 'kazan')

INSERT INTO cities (
  label, name)
VALUES
  ('moscow', 'Москва'),
  ('irkutsk', 'Иркутск'),
  ('novgorod', 'Новгород'),
  ('kazan', 'Казань'),
  ('omsk', 'Омск')


SELECT
  flights.id,
  c1.name AS flight_from,
  c2.name AS flight_to
FROM flights
LEFT JOIN cities AS c1 ON flights.flight_from = c1.label
LEFT JOIN cities AS c2 ON flights.flight_to = c2.label
ORDER BY id;
